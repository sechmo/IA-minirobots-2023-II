# Formulating the TRM using MEPX

We are going to use MEPX to create a program to calculate the TRM based on the stock prices of Ecopetrol (NYSE:EC), Bancolombia (NYSE:CIB) and Brent Crude Oil (NYMEX:BZW00). 

## Data
Data was taken from Google Finance [1,2,3] and Banco de la Republica [4] and was also segmented into 3 contiguous time groups:
- Training data: from 24/04/2023 to 19/07/2023 - 60 days
- Validation data: from 20/07/2023 to 16/08/2023 - 20 days
- Test data: from 17/08/2023 to 19/09/2023 - 23 days

## MEPX 
### Data loading
The 3 data sets were loaded with the last value being the TRM set as target (and the rest as inputs)
### Parameters 
The symbolic regression problem was set in order to enable multiple inputs (time series doesn't allow multiple inputs) and get the formula.

We ran the algorithm with the following parameters
![image](https://github.com/sechmo/IA-minirobots-2023-II/assets/70355173/f53c2629-2f8d-46f1-9e86-432f5c5e48f8)

## RESULTS
[Project file (data included)](https://github.com/sechmo/IA-minirobots-2023-II/blob/master/4.%20Programacion%20Genetica/3.%20TRM%20MEPX/TRM.xml)

The final result got a validation error of 595.55 and as can be seen, the resulting program, does diverge significantly in prediction outside of training data

![image](https://github.com/sechmo/IA-minirobots-2023-II/assets/70355173/0e6e439c-3995-4be0-9796-9bf33a42dadb)

The *simplified* resulting program was

```c++
//Generated by libmep version 2023.3.29.0-beta

#include <math.h>
#include <stdio.h>

void mepx(double *x /*inputs*/, double *outputs)
{
  double prg[10];

  prg[0] = x[2];
  prg[1] = x[0];
  prg[2] = x[2];
  prg[3] = prg[2] + prg[0];
  prg[4] = prg[1] + prg[1];
  prg[5] = prg[3] - prg[4];
  prg[6] = x[0];
  prg[7] = prg[3] + prg[5];
  prg[8] = prg[6] / prg[3];
  prg[9] = prg[7] / prg[8];

  outputs[0] = prg[9];

}

int main(void)
{

//example of utilization ...

  double x[3];
  x[0] = 11.610000;
  x[1] = 27.950000;
  x[2] = 80.360000;

  double outputs[1];

  mepx(x, outputs);

  printf("%lf", outputs[0]);
  getchar();
}
```
# Conclusions

The training data may be too limited to get a more consistent and good result, although there seem to be some correlation between the stock and oil prices and the TRM, there may be some other value that could perform better with the use of genetic programming.

# Bibliography
[1] “Precio y noticias de Bancolombia (CIB) - Google Finance.” https://www.google.com/finance/quote/CIB:NYSE (accessed Sep. 20, 2023).

[2] “Precio y noticias de Ecopetrol SA (EC) - Google Finance.” https://www.google.com/finance/quote/EC:NYSE (accessed Sep. 20, 2023).

[3] “Precios de contratos de futuros y noticias de Brent Crude Oil Last Day Financial Futures (BZW00) - Google Finance.” https://www.google.com/finance/quote/BZW00:NYMEX (accessed Sep. 20, 2023).

[4] Superintendencia Financiera de Colombia, “Tasa de cambio representativa del mercado (TRM).” Accessed: Sep. 20, 2023. [Online]. Available: https://www.banrep.gov.co/es/estadisticas/trm
